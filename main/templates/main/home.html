{% extends "main/base.html" %}
{% load static %}
{% block content %}

<!-- ================================================= -->
<!-- HERO BANNER (DialAddress Style) -->
<!-- ================================================= -->
<style>
.hero-section {
    background: url("{% static 'main/hero-bg.jpg' %}") center/cover no-repeat;
    position: relative;
    padding: 120px 0;
}
.hero-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.55);
}
.hero-content {
    position: relative;
    z-index: 2;
}
.hero-input {
    border-radius: 50px;
    padding: 14px 24px;
}
.hero-btn {
    border-radius: 50px;
    padding: 14px 28px;
}
</style>

<div class="hero-section text-white text-center">
    <div class="hero-overlay"></div>

    <div class="container hero-content">
        <h1 class="fw-bold display-5">Find Local Businesses Near You</h1>
        <p class="lead mb-4">Search & connect instantly ‚Äî just like DialAddress</p>

        <form action="{% url 'search' %}" method="get">
            <div class="row justify-content-center">
                <div class="col-md-6 mb-2">
                    <input type="text" name="q" class="form-control hero-input"
                           placeholder="Search business, service, category...">
                </div>
                <div class="col-md-2 mb-2">
                    <button class="btn btn-dark hero-btn w-100">Search</button>
                </div>
            </div>
        </form>
    </div>
</div>


<!-- ================================================= -->
<!-- CATEGORIES -->
<!-- ================================================= -->
<div class="container my-5">
    <h3 class="fw-bold text-center mb-4">Browse Categories</h3>

    <div class="row text-center justify-content-center">
        {% for c in categories %}
        <div class="col-6 col-md-2 mb-4">
            <a href="{% url 'category_listings' c.slug %}" class="text-decoration-none text-dark">
                <img src="{% if c.icon %}{{ c.icon.url }}{% else %}{% static 'main/defaults/category.png' %}{% endif %}"
                     style="width:60px;height:60px;object-fit:contain;">
                <p class="fw-semibold mt-2">{{ c.name }}</p>
            </a>
        </div>
        {% endfor %}
    </div>
</div>


<!-- ================================================= -->
<!-- FEATURED LISTINGS (WITH ACTION ICONS ‚ù§Ô∏è) -->
<!-- ================================================= -->
<div class="container my-5">
    <h3 class="fw-bold text-center mb-4">Featured Listings</h3>

    <div class="row g-4">
        {% for item in featured %}
        <div class="col-md-4">
            <div class="card shadow-sm h-100 border-0">

                {% if item.image %}
                <img src="{{ item.image.url }}" class="card-img-top"
                     style="height:220px;object-fit:cover;">
                {% endif %}

                <div class="card-body d-flex flex-column">
                    <h5 class="fw-bold">{{ item.title }}</h5>
                    <p class="text-muted small">{{ item.description|truncatechars:90 }}</p>

                    <!-- ACTION ICONS -->
                    <div class="d-flex gap-2 mb-3">

                        {% if item.phone %}
                        <a href="tel:{{ item.phone }}" class="btn btn-outline-primary btn-sm w-100">
                            üìû Call
                        </a>
                        {% endif %}

                        {% if item.phone %}
                        <a href="https://wa.me/{{ item.phone|cut:'+' }}" target="_blank"
                           class="btn btn-success btn-sm w-100">
                            üí¨ WhatsApp
                        </a>
                        {% endif %}

                        {% if item.website %}
                        <a href="{{ item.website }}" target="_blank"
                           class="btn btn-outline-dark btn-sm w-100">
                            üåê Website
                        </a>
                        {% endif %}

                    </div>

                    <!-- VIEW DETAILS -->
                    <a href="{% url 'business_page' item.slug %}"
                       class="btn btn-primary mt-auto">
                        View Details ‚Üí
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center">No featured listings available.</p>
        {% endfor %}
    </div>
</div>

{% endblock %}