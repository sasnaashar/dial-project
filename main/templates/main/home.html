{% extends "main/base.html" %}
{% load static %}
{% block content %}

<!-- MAIN HERO BANNER -->
<style>
  .hero-section {
    background: url("{% static 'main/hero-bg.jpg' %}") center/cover no-repeat;
    position: relative;
    padding: 120px 0 100px;
  }
  .hero-overlay {
    background: rgba(0, 0, 0, 0.55);
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
  }
  .hero-content {
    position: relative;
    z-index: 1;
  }
  .hero-input {
    border-radius: 50px;
    padding: 15px 25px;
    font-size: 1.1rem;
  }
  .hero-button {
    padding: 15px 30px;
    font-size: 1.1rem;
  }
</style>

<div class="hero-section text-white text-center">
  <div class="hero-overlay"></div>

  <div class="container hero-content">
    <h1 class="display-4 fw-bold">Find Trusted Local Businesses Near You</h1>
    <p class="lead mb-4">Search listings, explore categories, connect instantly — just like DialAddress.</p>

    <form action="{% url 'search' %}" method="GET">
      <div class="row justify-content-center gx-2">
        <div class="col-md-6">
          <input type="text" name="q" value="{{ request.GET.q }}" class="form-control hero-input" placeholder="Search businesses, services, categories...">
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-dark hero-button w-100">Search</button>
        </div>
      </div>
    </form>
  </div>
</div>


<!-- ===================== -->
<!-- CATEGORY LIST -->
<!-- ===================== -->
<div class="container mt-5">
  <h3 class="fw-bold text-center mb-4">Browse Categories</h3>

  <div class="row justify-content-center text-center">
    {% for c in categories %}
    <div class="col-6 col-md-2 mb-4">
      <a href="{% url 'category_listings' c.slug %}" class="text-decoration-none text-dark">
        <div class="p-3">
          <img
            src="{% if c.icon %}{{ c.icon.url }}{% else %}{% static 'main/defaults/category.png' %}{% endif %}"
            class="mb-2"
            style="width:60px; height:60px; object-fit:contain;">
          <p class="fw-semibold">{{ c.name }}</p>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</div>


<!-- ===================== -->
<!-- FEATURED LISTINGS -->
<!-- ===================== -->
<div class="container my-5">
  <h3 class="fw-bold text-center mb-4">Featured Listings</h3>

  <div class="row g-4">
    {% for item in featured %}
    <div class="col-md-4">
      <div class="card shadow-sm border-0 h-100">
        {% if item.image %}
        <img src="{{ item.image.url }}" class="card-img-top" style="height:220px; object-fit:cover;">
        {% else %}
        <img src="{% static 'main/defaults/no-image.jpg' %}" class="card-img-top" style="height:220px; object-fit:cover;">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="fw-bold">{{ item.title }}</h5>
          <p class="text-secondary small">{{ item.description|truncatechars:90 }}</p>
          <a href="{% url 'business_page' item.slug %}" class="btn btn-primary mt-auto">
            View Details →
          </a>
        </div>
      </div>
    </div>
    {% empty %}
    <p class="text-center">No featured listings yet.</p>
    {% endfor %}
  </div>
</div>

{% endblock %}